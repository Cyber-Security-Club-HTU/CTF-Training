# Local File Inclusion (LFI) 


## About

Some apps render the content of the web application files through calling them within a `GET` parameter, like this:
```PHP
<?php include($_GET['page']); ?>
```

```
https://example.com/?page=about.html
```
The vulnerability occurs when we can *include*, or render the content of local files from the webserver filesystem. These files can be any file that isn't intended to be disclosed to the internet.
```
https://example.com/?page=flag.txt
```

---
## Directory Traversal

Misconfiguration of codes, can result into a directory traversal vulnerability, that is used most of the time with some other vulnerabilities. It means that we can utilize the `../` to get access to files in others directories on the system; thus, bypassing the limitation we had in one directory only.
*Example:*
```
https://example.com/?page=../../../etc/passwd
```

---
## PHP Wrappers

PHP comes with many built-in *wrappers*, which are meant to be some kind of an identifier of what kind of data the rest of the URL represents. Those include:

- **Filter:** This allows us to get the content of the file base64 encoded. Which means that we can get the source code of the PHP files without having them executed server-side.
```
php://filter/convert.base64-encode/resource=FILE_NAME
```
*where "FILE_NAME" is your desired file, such as `app.php`*.

- **Data:** This accepts a base64 encoded filename or `php` code as follows:
```
data://text/plain;base64,ENCODED_STRING
```
*where "ENCODED_STRING" is your desired encoded string, such as `PD9waHAgcGhwaW5mbygpOyA/Pg==`, which has the plain text of `<? php phpinfo(); ?>`*.

>It’s important to consider that this wrapper would only be available if the option `allow_url_include` would be enabled.

---
## Notes

- Sometimes we don't know how deep are the current folder is, so keep try adding `../` until you get a hit.
- Escape the filtration by a mix of capitalization.
- Escape the filtration by URL encoding.
- Escape the filtration by double URL encoding.