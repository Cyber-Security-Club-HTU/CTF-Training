# Command Injection


## About

Command-Injection occurs when a user controlled input gets inserted into a command that will run on the server console (or terminal) directly.

It might return the output resulted from that command execution, and may not.

---
## The Vulnerability

We have couple of techniques we can apply to achieve our goal, which could be for example:
- List files.
- Read files content.
- Modify files.
- Recon the system.
- Create a reverse shell.

***Example***

We have the following `PHP` code, which executes `ping` shell command on a given IP address supplied by the user input.

```php
<?php
    if (isset($_GET["ip"])) {
    
        $ip_address = $_GET["ip"];
        
        passthru("ping $ip_address");
    }
?>
```

It is obvious that there is no filtration on the user input. The developer blindly trusts the user input to be as wanted always.

We can give it any fake address and then the `;` symbol followed by any shell-command we want. In our case we want to see the files existing in the current directory through `ls` command.

The payload will look like this:
```
https://example.com/?ip=127.0.0.1;ls
```

In the background,  it is going to execute:
```PHP
passthru("ping 127.0.0.1;ls");
```

---
## Payloads

- Use the `;` symbol to run another command. Example: `echo "Hi there"; ls -la` .
- Use the `${your_command}` to run inline commands, where the result of it will be returned to it's place. Example: `echo "Hi there, my name is ${whoami}"` .

>Refer always back to online resources and cheat sheets available when you need them.

---
## Notes

- Understand how is your input handled in the backend.
- Add any symbols as needed to end any string and insert your command.
- Spaces are not allowed in URLs. Use the `+` symbol or the `%20` instead of it.
- Bypass the filtration through a mix of capitalization.
- Bypass the filtration through URL encoding, or double encoding.
- Look up for any alternative commands that can achieve your goal, in case your traditional command is black-listed.